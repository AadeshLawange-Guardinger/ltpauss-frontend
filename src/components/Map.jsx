import React from "react";
import { MapContainer, TileLayer, Marker, Popup, Circle } from "react-leaflet";
import L from "leaflet";
import "leaflet/dist/leaflet.css";
import "../styles/Map.css"; // Import CSS for blinking effect

const Map = ({ mapData }) => {
  const { lat, long, doa } = mapData;

  // Define custom blinking red dot icon
  const blinkingRedDotIcon = L.divIcon({
    className: "blinking-dot-icon",
    iconSize: [12, 12],
  });

  return (
    <svg
      width="550"
      height="300"
      viewBox="0 0 651 354"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M13 129V113.5V98L1.5 90V13V1H299.5L314.5 13H650V179.5V192V353H248.5H236H13V129ZM640.5 31H23V342H640.5V31Z"
        fill="url(#paint0_linear_440_1953)"
        stroke="#09B5FE"
        stroke-width="2"
      />
      <rect x="24" y="32" width="616" height="309" fill="#0C4569" />
      
      <defs>
        <linearGradient
          id="paint0_linear_440_1953"
          x1="802.181"
          y1="-308.243"
          x2="-77.8047"
          y2="418.714"
          gradientUnits="userSpaceOnUse"
        >
          <stop offset="0.169223" stop-color="#00092A" stop-opacity="0.77" />
          <stop offset="0.861292" stop-color="#004970" />
          <stop offset="1" stop-color="#004970" stop-opacity="0" />
        </linearGradient>
      </defs>
      <foreignObject x="25" y="33" width="900" height="360">
        <MapContainer
          className="world-map-container dark"
          center={[lat, long]}
          zoom={13} // You can adjust the default zoom level here
          style={{ height: "308px", width: "614px" }}
        >
          <TileLayer url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png" />
          <Circle
            center={[lat, long]}
            radius={1000}
            fillOpacity={0.4}
            weight={0}
            opacity={0.4}
          />
          <Marker position={[lat, long]} icon={blinkingRedDotIcon}>
            <Popup>Direction of Arrival: {doa}</Popup>
          </Marker>
        </MapContainer>
      </foreignObject>
      <svg
        x="40"
        y="9"
        width="102"
        height="15"
        viewBox="0 0 102 15"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M0.254 0.293999H2.96V0.492C2.872 0.579999 2.81333 0.682666 2.784 0.799999C2.76933 0.902666 2.762 1.07133 2.762 1.306V11.976H9.054V14H0.254V0.293999ZM17.744 14.264C16.0573 14.264 14.7813 13.648 13.916 12.416C13.0507 11.184 12.618 9.43133 12.618 7.158C12.618 4.94333 13.0507 3.21267 13.916 1.966C14.7813 0.719333 16.0573 0.0959994 17.744 0.0959994C19.4013 0.0959994 20.6627 0.719333 21.528 1.966C22.408 3.21267 22.848 4.94333 22.848 7.158C22.848 9.43133 22.408 11.184 21.528 12.416C20.6627 13.648 19.4013 14.264 17.744 14.264ZM17.744 12.24C18.5653 12.24 19.2107 11.822 19.68 10.986C20.1493 10.1353 20.384 8.852 20.384 7.136C20.384 5.53733 20.1493 4.30533 19.68 3.44C19.2107 2.56 18.5653 2.12 17.744 2.12C16.8933 2.12 16.2333 2.56 15.764 3.44C15.3093 4.30533 15.082 5.53733 15.082 7.136C15.082 8.852 15.3093 10.1353 15.764 10.986C16.2333 11.822 16.8933 12.24 17.744 12.24ZM31.538 14.242C30.5407 14.242 29.624 14 28.788 13.516C27.9667 13.0173 27.3067 12.2473 26.808 11.206C26.324 10.1647 26.082 8.83733 26.082 7.224C26.082 5.87467 26.2433 4.74533 26.566 3.836C26.9033 2.912 27.3433 2.17867 27.886 1.636C28.4287 1.09333 29.0227 0.704666 29.668 0.47C30.328 0.220666 30.9807 0.0959994 31.626 0.0959994C32.6527 0.0959994 33.5327 0.330666 34.266 0.799999C35.014 1.26933 35.5787 1.92933 35.96 2.78L34.398 3.946L34.222 4.056L34.112 3.88C34.1267 3.77733 34.112 3.67467 34.068 3.572C34.0387 3.45467 33.9653 3.29333 33.848 3.088C33.5253 2.70667 33.188 2.45 32.836 2.318C32.4987 2.17133 32.1393 2.098 31.758 2.098C31.2007 2.098 30.6727 2.28867 30.174 2.67C29.69 3.05133 29.294 3.616 28.986 4.364C28.6927 5.09733 28.546 6.014 28.546 7.114C28.546 8.698 28.832 9.94467 29.404 10.854C29.9907 11.7487 30.724 12.196 31.604 12.196C32.1467 12.196 32.616 12.0787 33.012 11.844C33.408 11.6093 33.7673 11.2207 34.09 10.678L35.806 11.954C35.2927 12.79 34.684 13.384 33.98 13.736C33.2907 14.0733 32.4767 14.242 31.538 14.242ZM46.828 14L45.882 10.81H42.296L41.328 14H38.864L43.506 0.205999H44.694L49.336 14H46.828ZM44.1 4.804L42.824 9.028H45.354L44.1 4.804ZM56.002 14V2.384H52.306V0.293999H62.272V2.384H58.378V14H56.002ZM66.54 14V11.998H69.224V2.296H66.694V0.293999H74.262V2.296H71.578V11.998H74.372V14H66.54ZM83.744 14.264C82.0573 14.264 80.7813 13.648 79.916 12.416C79.0507 11.184 78.618 9.43133 78.618 7.158C78.618 4.94333 79.0507 3.21267 79.916 1.966C80.7813 0.719333 82.0573 0.0959994 83.744 0.0959994C85.4013 0.0959994 86.6627 0.719333 87.528 1.966C88.408 3.21267 88.848 4.94333 88.848 7.158C88.848 9.43133 88.408 11.184 87.528 12.416C86.6627 13.648 85.4013 14.264 83.744 14.264ZM83.744 12.24C84.5653 12.24 85.2107 11.822 85.68 10.986C86.1493 10.1353 86.384 8.852 86.384 7.136C86.384 5.53733 86.1493 4.30533 85.68 3.44C85.2107 2.56 84.5653 2.12 83.744 2.12C82.8933 2.12 82.2333 2.56 81.764 3.44C81.3093 4.30533 81.082 5.53733 81.082 7.136C81.082 8.852 81.3093 10.1353 81.764 10.986C82.2333 11.822 82.8933 12.24 83.744 12.24ZM92.214 0.293999H94.81L99.452 9.314L99.32 0.293999H101.74V0.492C101.667 0.579999 101.615 0.682666 101.586 0.799999C101.571 0.902666 101.564 1.07133 101.564 1.306V14H99.254L94.458 4.386V14H92.214V0.293999Z"
          fill="#89D2FF"
        />
      </svg>
    </svg>
  );
};

export default Map;
