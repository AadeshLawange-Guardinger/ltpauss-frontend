import React, { useState, useEffect } from 'react';
import { useNavigate  } from "react-router-dom";
import "../styles/BouyPanel.css"

export default function BouyPanel() {
    const [buoyIds, setBuoyIds] = useState([]);
    const [rectWidth, setRectWidth] = useState(52);
    const [isDecreasing, setIsDecreasing] = useState(false);
    const navigate = useNavigate();

    useEffect(() => {
      // Fetch buoy IDs from the API endpoint
      fetch('http://13.201.112.178:8000/bouy_id/')
        .then(response => response.json())
        .then(data => {
          // Set the fetched buoy IDs in state
          setBuoyIds(data.buoy_id);
        })
        .catch(error => {
          console.error('Error fetching buoy IDs:', error);
        });
  
      // Animation logic
      const interval = setInterval(() => {
        if (isDecreasing) {
          // Decrease the width until it's less than or equal to 20
          if (rectWidth <= 20) {
            setIsDecreasing(false); // Reset the decreasing flag
            clearInterval(interval); // Stop the animation
          } else {
            setRectWidth((Math.floor(Math.random() * (30 + 110)))); // Decrement the width
          }
        } else {
          // Increase the width until it reaches 112
          if (rectWidth >= 112) {
            setIsDecreasing(true); // Set the decreasing flag
          } else {
            setRectWidth((Math.floor(Math.random() * (20 + 90)))); // Increment the width
          }
        }
      },200);
  
      return () => clearInterval(interval); // Cleanup on unmount
    }, [rectWidth, isDecreasing]);
  
    const handleBouyClick = () => {
        navigate("/dashboard");
      };

  return (
    <div className="panel-container">
        <div className="grid-container">
            {buoyIds.map((buoyId, index) => (
                <div key={index} className="grid-item" onClick={handleBouyClick}>
                <svg width="380" height="287" viewBox="0 0 439 340" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M275.171 80.4692C271.561 72.7351 169.445 73.113 161.393 80.1255C161.346 80.9779 161.95 81.4905 165.69 82.5316L186.855 101.265L191.126 105.047C192.801 105.949 194.048 105.39 193.017 102.812L190.267 100.406L169.127 83.2191C174.995 83.9081 178.264 84.142 184.08 84.4222L196.97 99.8905H199.892L185.798 84.9378C194.05 85.2815 200.547 85.4614 206.938 85.5519V83.9833C188.494 83.7672 172.01 82.947 167.236 81.5004C164.679 80.8028 164.437 79.6668 167.236 79.2661C168.025 79.0608 168.946 78.8653 169.986 78.6796C177.61 77.3194 191.647 76.487 206.938 76.2008C214.345 76.0622 222.045 76.0517 229.453 76.1714C244.729 76.4183 258.76 77.2187 266.405 78.5908C267.297 78.7508 268.102 78.9186 268.811 79.0942C272.421 79.438 272.421 81.1567 268.811 81.5004C263.573 82.8701 247.546 83.7248 229.558 83.9833V85.5501C238.151 85.4047 243.309 85.2658 251.796 84.5941H253.343C259.669 83.9924 263.046 83.5677 268.811 82.7035L246.918 100.715L244.578 102.64C242.859 105.047 244.511 106.478 246.296 105.047L250.358 101.439L272.421 81.8442C273.283 81.7002 275.171 81.1567 275.171 80.4692Z" fill="#584244"/>
                    <path d="M159.33 266.605C172.221 265.574 172.221 269.698 180.814 270.902C191.061 271.992 201.267 270.902 222.578 269.355C231.817 268.911 240.625 272.105 256.093 273.308C266.105 274.086 271.31 271.692 281.874 272.635L240.281 122.234C240.281 119.827 235.945 120.392 230.828 119.827C236.28 121.351 238.825 124.939 242.172 137.531C248.285 169.119 250.293 189.409 251.796 229.309C252.077 237.837 252.318 242.62 252.828 251.137C251.826 259.486 246.64 262.824 238.219 261.449C217.502 257.58 208.657 261.449 191.126 263.683C174.283 264.542 161.129 265.794 161.837 257.496L159.33 266.605Z" fill="#E74344"/>
                    <path d="M230.828 119.827H205.907C201.691 120.325 199.137 120.575 199.204 121.719L161.837 257.496C161.129 265.794 174.283 264.542 191.126 263.683C208.657 261.449 217.502 257.58 238.219 261.449C246.64 262.824 251.826 259.486 252.828 251.137C252.318 242.62 252.077 237.837 251.796 229.309C250.293 189.409 248.285 169.119 242.172 137.531C238.825 124.939 236.28 121.351 230.828 119.827Z" fill="#EE5454"/>
                    <path d="M193.017 102.812C194.048 105.39 192.801 105.949 191.126 105.047L186.855 101.265C185.269 101.494 184.402 101.646 184.595 103.843V108.14C198.86 103.843 248.703 105.047 252.14 108.656V103.156C252.215 102.374 251.563 101.843 250.358 101.439L246.296 105.047C244.511 106.478 242.859 105.047 244.578 102.64L246.918 100.715C245.056 100.441 242.791 100.204 240.281 99.8905H237.703C234.745 99.7309 232.059 99.6061 229.558 99.5132C220.987 99.1947 214.6 99.2507 206.938 99.5608C204.724 99.6504 202.403 99.7613 199.892 99.8905H196.97C194.564 100.062 192.673 100.062 190.267 100.406L193.017 102.812Z" fill="#948081"/>
                    <path d="M252.14 108.656C248.703 105.047 198.86 103.843 184.595 108.14C184.717 110.159 190.255 110.847 206.595 111.578L206.938 108.14C215.572 107.645 220.484 107.593 229.453 108.14L229.797 111.578C241.488 111.087 249.068 111.036 252.14 108.656Z" fill="#6B5353"/>
                    <path d="M206.938 108.14L206.595 111.578L205.907 119.827H230.828L229.797 111.578L229.453 108.14C220.484 107.593 215.572 107.645 206.938 108.14Z" fill="#6B5353"/>
                    <path d="M289.092 282.245C278.78 281.693 272.377 281.118 261.249 282.245C250.121 283.372 238.562 279.323 224.469 279.323C215.332 278.811 209.688 280.698 195.079 280.698C181.771 280.604 175.722 279.754 167.58 276.745C161.79 275.602 155.926 276.992 147.3 278.073L165.69 306.994H205.907H212.438H227.906H234.094H273.452L289.092 282.245Z" fill="#07BAA4"/>
                    <path d="M251.796 84.5941L237.703 99.8905H240.281L253.343 84.5941H251.796Z" fill="#584244"/>
                    <path d="M206.938 85.5519V99.5608C214.6 99.2507 220.987 99.1947 229.558 99.5132L229.453 85.5519L229.558 85.5501V83.9833V80.8231L229.453 76.1714C222.045 76.0517 214.345 76.0622 206.938 76.2008V80.8231V83.9833V85.5519Z" fill="#FE0000"/>
                    <path d="M212.094 69.1266C212.249 67.6066 213.641 66.7204 215.532 67.0641C216.391 67.4079 216.735 68.611 215.532 69.6422C213.813 70.6734 212.094 70.3297 212.094 69.1266Z" fill="#A0C6FF"/>
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M216.735 65.5165C212.317 66.2902 210.032 67.9227 208.313 71.3601H228.078C226.016 66.3767 221.655 65.4825 216.735 65.5165ZM215.532 67.0641C213.641 66.7204 212.249 67.6066 212.094 69.1266C212.094 70.3297 213.813 70.6734 215.532 69.6422C216.735 68.611 216.391 67.4079 215.532 67.0641Z" fill="#FE0000"/>
                    <path d="M200.064 71.3601C172.744 72.5324 161.842 73.4497 161.393 76.1725C161.114 76.3554 161.565 77.8912 161.393 80.1255C169.445 73.113 271.561 72.7351 275.171 80.4692C275.717 78.6259 275.747 77.8279 275.171 76.8599C274.573 73.7636 259.187 71.8757 241.14 71.3601H228.078H208.313H200.064Z" fill="#937F7F"/>
                    <path d="M268.811 81.5004C272.421 81.1567 272.421 79.438 268.811 79.0942C268.102 78.9186 267.297 78.7508 266.405 78.5908C257.883 79.861 244.199 80.5829 229.558 80.8231V83.9833C247.546 83.7248 263.573 82.8701 268.811 81.5004Z" fill="#937F7F"/>
                    <path d="M167.236 79.2661C164.437 79.6668 164.679 80.8028 167.236 81.5004C172.01 82.947 188.494 83.7672 206.938 83.9833V80.8231C191.683 80.5769 177.741 79.8366 169.986 78.6796C168.946 78.8653 168.025 79.0608 167.236 79.2661Z" fill="#937F7F"/>
                    <path d="M429.837 278.073C397.999 276.875 363.018 285.652 314.268 280.759C303.873 279.715 298.717 282.761 289.092 282.245L273.452 306.994H234.094C234.094 317.994 224.469 321.947 217.766 320.916C209.516 319.025 206.493 313.268 205.907 306.994H165.69L147.3 278.073C144.248 278.456 140.85 278.8 136.987 278.979C121.342 279.968 112.433 279.903 96.2543 278.464C72.1925 273.823 38.5226 277.604 10.3359 280.698V332.527L429.837 335.402V278.073Z" fill="#0AD9BD"/>
                    <path d="M180.814 270.902C172.221 269.698 172.221 265.574 159.33 266.605L136.987 269.183C120.487 270.49 107.941 270.902 96.2543 268.495C80.4422 263.855 39.0382 267.464 10.3359 271.417V280.698C38.5226 277.604 72.1925 273.823 96.2543 278.464C112.433 279.903 121.342 279.968 136.987 278.979C140.85 278.8 144.248 278.456 147.3 278.073C155.926 276.992 161.79 275.602 167.58 276.745C175.722 279.754 181.771 280.604 195.079 280.698C209.688 280.698 215.332 278.811 224.469 279.323C238.562 279.323 250.121 283.372 261.249 282.245C272.377 281.118 278.78 281.693 289.092 282.245C298.717 282.761 303.873 279.715 314.268 280.759C363.018 285.652 397.999 276.875 429.837 278.073V267.589C402.853 267.589 355.179 275.447 333.606 273.308C306.107 267.808 302.67 273.308 287.03 273.308C285.167 272.994 283.46 272.777 281.874 272.635C271.31 271.692 266.105 274.086 256.093 273.308C240.625 272.105 231.817 268.911 222.578 269.355C201.267 270.902 191.061 271.992 180.814 270.902Z" fill="#33FFE4"/>
                    <path d="M212.438 306.994C213.813 316.963 227.047 316.619 227.906 306.994H212.438Z" fill="#0AD9BD"/>
                    <path d="M227.906 306.994C227.047 316.619 213.813 316.963 212.438 306.994H205.907C206.493 313.268 209.516 319.025 217.766 320.916C224.469 321.947 234.094 317.994 234.094 306.994H227.906Z" fill="#047164"/>
                    <path d="M207.111 143.963C208.829 136.056 203.673 134.51 200.752 140.182C197.519 145.707 197.311 148.91 196.455 154.275C195.841 159.545 194.736 164.415 193.017 173.868L174.971 252.928C172.909 264.271 184.94 271.833 187.002 262.209L188.893 249.662L198.002 190.195L203.845 157.024C204.736 151.706 205.515 148.884 207.111 143.963Z" fill="#FF675C"/>
                    <rect x="5.97924" y="44.3542" width="426.97" height="290.041" stroke="#0CFEFF" stroke-width="9.95848"/>
                    <path d="M437.703 9.5V17.6478V36.2634H420.276H1.00128V1H159.626L171.501 9.5H437.703Z" fill="url(#paint0_linear_460_1843)" stroke="#09B5FE" stroke-width="1.35797"/>
                    <path d="M254.587 27.5L253.944 25.334H251.51L250.852 27.5H249.179L252.331 18.1341H253.138L256.29 27.5H254.587ZM252.734 21.256L251.868 24.1241H253.586L252.734 21.256ZM262.13 27.6643C261.453 27.6643 260.831 27.5 260.263 27.1714C259.705 26.8328 259.257 26.31 258.919 25.6029C258.59 24.8959 258.426 23.9946 258.426 22.8992C258.426 21.983 258.535 21.2162 258.754 20.5988C258.983 19.9714 259.282 19.4735 259.651 19.105C260.019 18.7365 260.422 18.4726 260.861 18.3133C261.309 18.144 261.752 18.0594 262.19 18.0594C262.887 18.0594 263.485 18.2187 263.983 18.5374C264.49 18.856 264.874 19.3042 265.133 19.8818L264.072 20.6735L263.953 20.7482L263.878 20.6287C263.888 20.5589 263.878 20.4892 263.848 20.4195C263.828 20.3399 263.778 20.2303 263.699 20.0909C263.48 19.832 263.251 19.6577 263.012 19.5681C262.783 19.4685 262.539 19.4187 262.28 19.4187C261.901 19.4187 261.543 19.5482 261.204 19.8071C260.875 20.066 260.607 20.4494 260.397 20.9573C260.198 21.4552 260.099 22.0776 260.099 22.8245C260.099 23.9 260.293 24.7465 260.681 25.3639C261.08 25.9714 261.578 26.2751 262.175 26.2751C262.544 26.2751 262.862 26.1954 263.131 26.0361C263.4 25.8768 263.644 25.6129 263.863 25.2444L265.028 26.1108C264.68 26.6784 264.266 27.0817 263.788 27.3207C263.32 27.5498 262.768 27.6643 262.13 27.6643ZM269.778 27.5V19.6129H267.269V18.1938H274.036V19.6129H271.392V27.5H269.778ZM276.934 27.5V26.1407H278.756V19.5531H277.038V18.1938H282.177V19.5531H280.354V26.1407H282.251V27.5H276.934ZM288.077 27.5299L285.09 18.1938H286.763L288.719 24.7365L290.542 18.1938H292.17L289.212 27.5299H288.077ZM294.575 27.5V18.1938H300.64V19.5681H296.218V21.9581H299.848V23.3473H296.218V26.1257H300.595V27.5H294.575Z" fill="#89D2FF"/>
                    <rect x="310.5" y="15.5" width="117" height="14" stroke="#00FF94"/>
                    <defs>
                    <linearGradient id="paint0_linear_460_1843" x1="-105.949" y1="-200.472" x2="491.55" y2="293.122" gradientUnits="userSpaceOnUse">
                    <stop offset="0.169223" stop-color="#00092A" stop-opacity="0.77"/>
                    <stop offset="0.861292" stop-color="#004970"/>
                    <stop offset="1" stop-color="#004970" stop-opacity="0"/>
                    </linearGradient>
                    </defs>
                    <text x="75" y="21" textAnchor="middle" alignmentBaseline="middle" fill="#89D2FF" fontSize="25">
                    {buoyId}
                    </text>
                    <svg x="100" y="18" height="9" viewBox="0 0 12 9" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <rect width={rectWidth} height="9" fill="#0CFEFF"/>
                    </svg>
                </svg>  
                </div>
            ))}
        </div>
    </div>
  );
}
